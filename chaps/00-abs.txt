Web applications support important areas such as finance, e-commerce, and healthcare, making their reliability and security of paramount importance. However, web frontends are inherently manipulable, and abnormal client behaviors may evade backend checks, creating exploitable vulnerabilities. Log analysis has emerged as an effective defense by capturing client-server interactions. Two main categories of log analysis methods exist: model-learning-based approaches that train predictive models from normal logs, and rule-learning-based approaches that mine logical constraints from logs. However, these two categories have their limitations. Model-learning-based methods detect anomalies by training predictive models on normal logs, but they suffer from poor interpretability, high false positive rates, and difficulty in capturing subtle attacks. Rule-learning-based methods provide stronger interpretability by extracting explicit constraints, as exemplified by WebNorm, but they rely heavily on program instrumentation, heavyweight proprietary models, and manually engineered prompts.

In this paper, we present AgenticNorm, a lightweight anomaly detection framework built upon lightweight, locally deployable LLMs. AgenticNorm avoids program-analysis dependence, removes reliance on heavyweight proprietary models, and mitigates prompt sensitivity through three innovations: (1) eliminating source-code dependence via frequency-based inter-API relation discovery, (2) reducing log complexity through field clustering into semantically coherent groups, and (3) iteratively refining prompts with adversarially generated attack logs. These components are integrated into a multi-agent workflow that progressively improves anomaly detection without extensive human intervention.

We implement and evaluate AgenticNorm on popular benchmarks, including TrainTicket and NiceFish. Results demonstrate that AgenticNorm achieves effective and interpretable anomaly detection while requiring significantly less contextual information compared to existing approaches.